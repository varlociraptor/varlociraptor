# A false positive SNV that occurs because of the following situation:
#
# Next to it, there is a deletion. Both the SNV and the deletion are inside of a repeat.
# Reads with the deletion are by default realigned against the SNV. It can happen that this
# realignment generates evidence for the SNV (it is better to have the SNV for the indel reads than
# having nothing). However, if Varlociraptor would consider the entire haplotype with the deletion 
# as well, there is no evidence for the SNV (deletion + SNV is worse than deletion alone).
#
# With Freebayes, such problems should not occur because it will report these variants as longer
# replacements. Whenever one has a caller that reports atomic variants, this can be a problem.
# However, this is fixed in latest Varlociraptor because it checks the edit distance after realignments.
# If that exceeds a maximum derived from the expected sequencing errors likelihoods are corrected assuming
# a third allele not represented by the considered variant. This is exactly what we have here.

expected:
  allelefreqs:
    - sample == 0.0

# necessary bam files
samples:
  sample:
    path: 'sample.bam'
    properties: '{"insert_size":{"mean":161.6714188730482,"sd":83.12118494449504},"max_del_cigar_len":323,"max_ins_cigar_len":20,"frac_max_softclip":0.9603960396039604,"max_read_len":101,"max_mapq":60,"gap_params":{"prob_insertion_artifact":-7.394138396809515,"prob_deletion_artifact":-7.736143151000453,"prob_insertion_extend_artifact":-0.029641389242464598,"prob_deletion_extend_artifact":-0.4001936146146523},"hop_params":{"prob_seq_homopolymer":[null,null,null,null],"prob_ref_homopolymer":[null,null,null,null],"prob_seq_extend_homopolymer":[null,null,null,null],"prob_ref_extend_homopolymer":[null,null,null,null]},"wildtype_homopolymer_error_model":{"2":0.00018338529249954154,"1":0.0016199034170792837,"0":0.9984488660676081,"6":0.00006112843083318051,"7":7.641053854147563e-6,"8":0.000030564215416590254,"-2":0.000022923161562442692,"4":0.00003820526927073782,"-1":7.641053854147563e-6,"-4":7.641053854147563e-6},"initial":false}'
    options: '{"Preprocess":{"kind":{"Variants":{"reference":"?","candidates":"?","bam":"?","report_fragment_ids":true,"omit_mapq_adjustment":true,"reference_buffer_size":10,"min_bam_refetch_distance":1,"alignment_properties":null,"output":"?","propagate_info_fields":[],"protocol_strandedness":"Opposite","realignment_window":64,"max_depth":200,"omit_insert_size":false,"pairhmm_mode":"exact","log_mode":"default","output_raw_observations":"results/observations_log/SRR716424_B"}}}}'
  

# candidate variant
candidate: 'candidates.vcf'

scenario: 'scenario.yaml'

omit_strand_bias: true
omit_read_orientation_bias: true
omit_read_position_bias: true
omit_softclip_bias: true
omit_homopolymer_artifact_detection: true
omit_alt_locus_bias: true


# reference sequence
reference:
  path: 'ref.fa'

mode: Generic

version: '4'
