<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="Source to the Rust file `/home/travis/.cargo/registry/src/github.com-1ecc6299db9ec823/GSL-0.4.28/src/types/ordinary_differential_equations.rs`.">
    <meta name="keywords" content="rust, rustlang, rust-lang">

    <title>ordinary_differential_equations.rs.html -- source</title>

    <link rel="stylesheet" type="text/css" href="../../../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../../../main.css">
    

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content source"><pre class="line-numbers"><span id="1">  1</span>
<span id="2">  2</span>
<span id="3">  3</span>
<span id="4">  4</span>
<span id="5">  5</span>
<span id="6">  6</span>
<span id="7">  7</span>
<span id="8">  8</span>
<span id="9">  9</span>
<span id="10"> 10</span>
<span id="11"> 11</span>
<span id="12"> 12</span>
<span id="13"> 13</span>
<span id="14"> 14</span>
<span id="15"> 15</span>
<span id="16"> 16</span>
<span id="17"> 17</span>
<span id="18"> 18</span>
<span id="19"> 19</span>
<span id="20"> 20</span>
<span id="21"> 21</span>
<span id="22"> 22</span>
<span id="23"> 23</span>
<span id="24"> 24</span>
<span id="25"> 25</span>
<span id="26"> 26</span>
<span id="27"> 27</span>
<span id="28"> 28</span>
<span id="29"> 29</span>
<span id="30"> 30</span>
<span id="31"> 31</span>
<span id="32"> 32</span>
<span id="33"> 33</span>
<span id="34"> 34</span>
<span id="35"> 35</span>
<span id="36"> 36</span>
<span id="37"> 37</span>
<span id="38"> 38</span>
<span id="39"> 39</span>
<span id="40"> 40</span>
<span id="41"> 41</span>
<span id="42"> 42</span>
<span id="43"> 43</span>
<span id="44"> 44</span>
<span id="45"> 45</span>
<span id="46"> 46</span>
<span id="47"> 47</span>
<span id="48"> 48</span>
<span id="49"> 49</span>
<span id="50"> 50</span>
<span id="51"> 51</span>
<span id="52"> 52</span>
<span id="53"> 53</span>
<span id="54"> 54</span>
<span id="55"> 55</span>
<span id="56"> 56</span>
<span id="57"> 57</span>
<span id="58"> 58</span>
<span id="59"> 59</span>
<span id="60"> 60</span>
<span id="61"> 61</span>
<span id="62"> 62</span>
<span id="63"> 63</span>
<span id="64"> 64</span>
<span id="65"> 65</span>
<span id="66"> 66</span>
<span id="67"> 67</span>
<span id="68"> 68</span>
<span id="69"> 69</span>
<span id="70"> 70</span>
<span id="71"> 71</span>
<span id="72"> 72</span>
<span id="73"> 73</span>
<span id="74"> 74</span>
<span id="75"> 75</span>
<span id="76"> 76</span>
<span id="77"> 77</span>
<span id="78"> 78</span>
<span id="79"> 79</span>
<span id="80"> 80</span>
<span id="81"> 81</span>
<span id="82"> 82</span>
<span id="83"> 83</span>
<span id="84"> 84</span>
<span id="85"> 85</span>
<span id="86"> 86</span>
<span id="87"> 87</span>
<span id="88"> 88</span>
<span id="89"> 89</span>
<span id="90"> 90</span>
<span id="91"> 91</span>
<span id="92"> 92</span>
<span id="93"> 93</span>
<span id="94"> 94</span>
<span id="95"> 95</span>
<span id="96"> 96</span>
<span id="97"> 97</span>
<span id="98"> 98</span>
<span id="99"> 99</span>
<span id="100">100</span>
<span id="101">101</span>
<span id="102">102</span>
<span id="103">103</span>
<span id="104">104</span>
<span id="105">105</span>
<span id="106">106</span>
<span id="107">107</span>
<span id="108">108</span>
<span id="109">109</span>
<span id="110">110</span>
<span id="111">111</span>
<span id="112">112</span>
<span id="113">113</span>
<span id="114">114</span>
<span id="115">115</span>
<span id="116">116</span>
<span id="117">117</span>
<span id="118">118</span>
<span id="119">119</span>
<span id="120">120</span>
<span id="121">121</span>
<span id="122">122</span>
<span id="123">123</span>
<span id="124">124</span>
<span id="125">125</span>
<span id="126">126</span>
<span id="127">127</span>
<span id="128">128</span>
<span id="129">129</span>
<span id="130">130</span>
<span id="131">131</span>
<span id="132">132</span>
<span id="133">133</span>
<span id="134">134</span>
<span id="135">135</span>
<span id="136">136</span>
<span id="137">137</span>
<span id="138">138</span>
<span id="139">139</span>
<span id="140">140</span>
<span id="141">141</span>
<span id="142">142</span>
<span id="143">143</span>
<span id="144">144</span>
<span id="145">145</span>
<span id="146">146</span>
<span id="147">147</span>
<span id="148">148</span>
<span id="149">149</span>
<span id="150">150</span>
<span id="151">151</span>
<span id="152">152</span>
<span id="153">153</span>
<span id="154">154</span>
<span id="155">155</span>
<span id="156">156</span>
<span id="157">157</span>
<span id="158">158</span>
<span id="159">159</span>
<span id="160">160</span>
<span id="161">161</span>
<span id="162">162</span>
<span id="163">163</span>
<span id="164">164</span>
<span id="165">165</span>
<span id="166">166</span>
<span id="167">167</span>
<span id="168">168</span>
<span id="169">169</span>
<span id="170">170</span>
<span id="171">171</span>
<span id="172">172</span>
<span id="173">173</span>
<span id="174">174</span>
<span id="175">175</span>
<span id="176">176</span>
<span id="177">177</span>
<span id="178">178</span>
<span id="179">179</span>
<span id="180">180</span>
<span id="181">181</span>
<span id="182">182</span>
<span id="183">183</span>
<span id="184">184</span>
<span id="185">185</span>
<span id="186">186</span>
<span id="187">187</span>
<span id="188">188</span>
<span id="189">189</span>
<span id="190">190</span>
<span id="191">191</span>
<span id="192">192</span>
<span id="193">193</span>
<span id="194">194</span>
<span id="195">195</span>
<span id="196">196</span>
<span id="197">197</span>
<span id="198">198</span>
<span id="199">199</span>
<span id="200">200</span>
<span id="201">201</span>
<span id="202">202</span>
<span id="203">203</span>
<span id="204">204</span>
<span id="205">205</span>
<span id="206">206</span>
<span id="207">207</span>
<span id="208">208</span>
<span id="209">209</span>
<span id="210">210</span>
<span id="211">211</span>
<span id="212">212</span>
<span id="213">213</span>
<span id="214">214</span>
<span id="215">215</span>
<span id="216">216</span>
<span id="217">217</span>
<span id="218">218</span>
<span id="219">219</span>
<span id="220">220</span>
<span id="221">221</span>
<span id="222">222</span>
<span id="223">223</span>
<span id="224">224</span>
<span id="225">225</span>
<span id="226">226</span>
<span id="227">227</span>
<span id="228">228</span>
<span id="229">229</span>
<span id="230">230</span>
<span id="231">231</span>
<span id="232">232</span>
<span id="233">233</span>
<span id="234">234</span>
<span id="235">235</span>
<span id="236">236</span>
<span id="237">237</span>
<span id="238">238</span>
<span id="239">239</span>
<span id="240">240</span>
<span id="241">241</span>
<span id="242">242</span>
<span id="243">243</span>
<span id="244">244</span>
<span id="245">245</span>
<span id="246">246</span>
<span id="247">247</span>
<span id="248">248</span>
<span id="249">249</span>
<span id="250">250</span>
<span id="251">251</span>
<span id="252">252</span>
<span id="253">253</span>
<span id="254">254</span>
<span id="255">255</span>
<span id="256">256</span>
<span id="257">257</span>
<span id="258">258</span>
<span id="259">259</span>
<span id="260">260</span>
<span id="261">261</span>
<span id="262">262</span>
<span id="263">263</span>
<span id="264">264</span>
<span id="265">265</span>
<span id="266">266</span>
<span id="267">267</span>
<span id="268">268</span>
<span id="269">269</span>
<span id="270">270</span>
<span id="271">271</span>
<span id="272">272</span>
<span id="273">273</span>
<span id="274">274</span>
<span id="275">275</span>
<span id="276">276</span>
<span id="277">277</span>
<span id="278">278</span>
<span id="279">279</span>
<span id="280">280</span>
<span id="281">281</span>
<span id="282">282</span>
<span id="283">283</span>
<span id="284">284</span>
<span id="285">285</span>
<span id="286">286</span>
<span id="287">287</span>
<span id="288">288</span>
<span id="289">289</span>
<span id="290">290</span>
<span id="291">291</span>
<span id="292">292</span>
<span id="293">293</span>
<span id="294">294</span>
<span id="295">295</span>
<span id="296">296</span>
<span id="297">297</span>
<span id="298">298</span>
<span id="299">299</span>
<span id="300">300</span>
<span id="301">301</span>
<span id="302">302</span>
<span id="303">303</span>
<span id="304">304</span>
<span id="305">305</span>
<span id="306">306</span>
<span id="307">307</span>
<span id="308">308</span>
<span id="309">309</span>
<span id="310">310</span>
<span id="311">311</span>
<span id="312">312</span>
<span id="313">313</span>
<span id="314">314</span>
<span id="315">315</span>
<span id="316">316</span>
<span id="317">317</span>
<span id="318">318</span>
<span id="319">319</span>
<span id="320">320</span>
<span id="321">321</span>
<span id="322">322</span>
<span id="323">323</span>
<span id="324">324</span>
<span id="325">325</span>
<span id="326">326</span>
<span id="327">327</span>
<span id="328">328</span>
<span id="329">329</span>
<span id="330">330</span>
<span id="331">331</span>
<span id="332">332</span>
<span id="333">333</span>
<span id="334">334</span>
<span id="335">335</span>
<span id="336">336</span>
<span id="337">337</span>
<span id="338">338</span>
<span id="339">339</span>
<span id="340">340</span>
<span id="341">341</span>
<span id="342">342</span>
<span id="343">343</span>
<span id="344">344</span>
<span id="345">345</span>
<span id="346">346</span>
<span id="347">347</span>
<span id="348">348</span>
<span id="349">349</span>
<span id="350">350</span>
<span id="351">351</span>
<span id="352">352</span>
<span id="353">353</span>
<span id="354">354</span>
<span id="355">355</span>
<span id="356">356</span>
<span id="357">357</span>
<span id="358">358</span>
<span id="359">359</span>
<span id="360">360</span>
<span id="361">361</span>
<span id="362">362</span>
<span id="363">363</span>
<span id="364">364</span>
<span id="365">365</span>
<span id="366">366</span>
<span id="367">367</span>
<span id="368">368</span>
<span id="369">369</span>
<span id="370">370</span>
<span id="371">371</span>
<span id="372">372</span>
<span id="373">373</span>
<span id="374">374</span>
<span id="375">375</span>
<span id="376">376</span>
<span id="377">377</span>
<span id="378">378</span>
<span id="379">379</span>
<span id="380">380</span>
<span id="381">381</span>
<span id="382">382</span>
<span id="383">383</span>
<span id="384">384</span>
<span id="385">385</span>
<span id="386">386</span>
<span id="387">387</span>
<span id="388">388</span>
<span id="389">389</span>
<span id="390">390</span>
<span id="391">391</span>
<span id="392">392</span>
<span id="393">393</span>
<span id="394">394</span>
<span id="395">395</span>
<span id="396">396</span>
<span id="397">397</span>
<span id="398">398</span>
<span id="399">399</span>
<span id="400">400</span>
<span id="401">401</span>
<span id="402">402</span>
<span id="403">403</span>
<span id="404">404</span>
<span id="405">405</span>
<span id="406">406</span>
<span id="407">407</span>
<span id="408">408</span>
<span id="409">409</span>
<span id="410">410</span>
<span id="411">411</span>
<span id="412">412</span>
<span id="413">413</span>
<span id="414">414</span>
<span id="415">415</span>
<span id="416">416</span>
<span id="417">417</span>
<span id="418">418</span>
<span id="419">419</span>
<span id="420">420</span>
<span id="421">421</span>
<span id="422">422</span>
<span id="423">423</span>
<span id="424">424</span>
<span id="425">425</span>
<span id="426">426</span>
<span id="427">427</span>
<span id="428">428</span>
<span id="429">429</span>
<span id="430">430</span>
<span id="431">431</span>
<span id="432">432</span>
<span id="433">433</span>
<span id="434">434</span>
<span id="435">435</span>
<span id="436">436</span>
<span id="437">437</span>
<span id="438">438</span>
<span id="439">439</span>
<span id="440">440</span>
<span id="441">441</span>
<span id="442">442</span>
<span id="443">443</span>
<span id="444">444</span>
<span id="445">445</span>
<span id="446">446</span>
<span id="447">447</span>
<span id="448">448</span>
<span id="449">449</span>
<span id="450">450</span>
<span id="451">451</span>
<span id="452">452</span>
<span id="453">453</span>
<span id="454">454</span>
<span id="455">455</span>
<span id="456">456</span>
<span id="457">457</span>
<span id="458">458</span>
<span id="459">459</span>
<span id="460">460</span>
<span id="461">461</span>
<span id="462">462</span>
<span id="463">463</span>
<span id="464">464</span>
<span id="465">465</span>
<span id="466">466</span>
<span id="467">467</span>
<span id="468">468</span>
<span id="469">469</span>
<span id="470">470</span>
<span id="471">471</span>
<span id="472">472</span>
<span id="473">473</span>
<span id="474">474</span>
<span id="475">475</span>
<span id="476">476</span>
<span id="477">477</span>
<span id="478">478</span>
<span id="479">479</span>
<span id="480">480</span>
<span id="481">481</span>
<span id="482">482</span>
<span id="483">483</span>
<span id="484">484</span>
<span id="485">485</span>
<span id="486">486</span>
<span id="487">487</span>
<span id="488">488</span>
<span id="489">489</span>
<span id="490">490</span>
<span id="491">491</span>
<span id="492">492</span>
<span id="493">493</span>
<span id="494">494</span>
<span id="495">495</span>
<span id="496">496</span>
<span id="497">497</span>
<span id="498">498</span>
<span id="499">499</span>
<span id="500">500</span>
<span id="501">501</span>
<span id="502">502</span>
<span id="503">503</span>
<span id="504">504</span>
<span id="505">505</span>
<span id="506">506</span>
<span id="507">507</span>
<span id="508">508</span>
<span id="509">509</span>
<span id="510">510</span>
<span id="511">511</span>
<span id="512">512</span>
<span id="513">513</span>
<span id="514">514</span>
<span id="515">515</span>
<span id="516">516</span>
<span id="517">517</span>
<span id="518">518</span>
<span id="519">519</span>
<span id="520">520</span>
<span id="521">521</span>
<span id="522">522</span>
<span id="523">523</span>
<span id="524">524</span>
<span id="525">525</span>
<span id="526">526</span>
<span id="527">527</span>
<span id="528">528</span>
<span id="529">529</span>
<span id="530">530</span>
<span id="531">531</span>
<span id="532">532</span>
<span id="533">533</span>
<span id="534">534</span>
<span id="535">535</span>
<span id="536">536</span>
<span id="537">537</span>
<span id="538">538</span>
<span id="539">539</span>
<span id="540">540</span>
<span id="541">541</span>
<span id="542">542</span>
<span id="543">543</span>
<span id="544">544</span>
<span id="545">545</span>
<span id="546">546</span>
<span id="547">547</span>
<span id="548">548</span>
<span id="549">549</span>
<span id="550">550</span>
<span id="551">551</span>
<span id="552">552</span>
<span id="553">553</span>
<span id="554">554</span>
<span id="555">555</span>
<span id="556">556</span>
<span id="557">557</span>
<span id="558">558</span>
<span id="559">559</span>
<span id="560">560</span>
<span id="561">561</span>
<span id="562">562</span>
<span id="563">563</span>
<span id="564">564</span>
<span id="565">565</span>
<span id="566">566</span>
<span id="567">567</span>
<span id="568">568</span>
<span id="569">569</span>
<span id="570">570</span>
<span id="571">571</span>
<span id="572">572</span>
<span id="573">573</span>
<span id="574">574</span>
<span id="575">575</span>
<span id="576">576</span>
<span id="577">577</span>
<span id="578">578</span>
<span id="579">579</span>
<span id="580">580</span>
<span id="581">581</span>
<span id="582">582</span>
<span id="583">583</span>
<span id="584">584</span>
<span id="585">585</span>
<span id="586">586</span>
<span id="587">587</span>
<span id="588">588</span>
<span id="589">589</span>
<span id="590">590</span>
<span id="591">591</span>
<span id="592">592</span>
<span id="593">593</span>
<span id="594">594</span>
<span id="595">595</span>
<span id="596">596</span>
<span id="597">597</span>
<span id="598">598</span>
<span id="599">599</span>
<span id="600">600</span>
<span id="601">601</span>
<span id="602">602</span>
<span id="603">603</span>
<span id="604">604</span>
<span id="605">605</span>
<span id="606">606</span>
<span id="607">607</span>
<span id="608">608</span>
<span id="609">609</span>
<span id="610">610</span>
<span id="611">611</span>
<span id="612">612</span>
<span id="613">613</span>
<span id="614">614</span>
<span id="615">615</span>
<span id="616">616</span>
<span id="617">617</span>
<span id="618">618</span>
<span id="619">619</span>
<span id="620">620</span>
<span id="621">621</span>
<span id="622">622</span>
<span id="623">623</span>
<span id="624">624</span>
<span id="625">625</span>
<span id="626">626</span>
<span id="627">627</span>
<span id="628">628</span>
<span id="629">629</span>
<span id="630">630</span>
<span id="631">631</span>
<span id="632">632</span>
<span id="633">633</span>
<span id="634">634</span>
<span id="635">635</span>
<span id="636">636</span>
<span id="637">637</span>
<span id="638">638</span>
<span id="639">639</span>
<span id="640">640</span>
<span id="641">641</span>
<span id="642">642</span>
<span id="643">643</span>
<span id="644">644</span>
<span id="645">645</span>
<span id="646">646</span>
<span id="647">647</span>
<span id="648">648</span>
<span id="649">649</span>
<span id="650">650</span>
<span id="651">651</span>
<span id="652">652</span>
<span id="653">653</span>
<span id="654">654</span>
<span id="655">655</span>
<span id="656">656</span>
<span id="657">657</span>
<span id="658">658</span>
<span id="659">659</span>
<span id="660">660</span>
<span id="661">661</span>
<span id="662">662</span>
<span id="663">663</span>
<span id="664">664</span>
<span id="665">665</span>
<span id="666">666</span>
<span id="667">667</span>
<span id="668">668</span>
<span id="669">669</span>
<span id="670">670</span>
<span id="671">671</span>
<span id="672">672</span>
<span id="673">673</span>
<span id="674">674</span>
<span id="675">675</span>
<span id="676">676</span>
<span id="677">677</span>
<span id="678">678</span>
<span id="679">679</span>
<span id="680">680</span>
<span id="681">681</span>
<span id="682">682</span>
<span id="683">683</span>
<span id="684">684</span>
<span id="685">685</span>
<span id="686">686</span>
<span id="687">687</span>
<span id="688">688</span>
<span id="689">689</span>
<span id="690">690</span>
<span id="691">691</span>
<span id="692">692</span>
<span id="693">693</span>
<span id="694">694</span>
<span id="695">695</span>
<span id="696">696</span>
<span id="697">697</span>
<span id="698">698</span>
<span id="699">699</span>
<span id="700">700</span>
<span id="701">701</span>
<span id="702">702</span>
<span id="703">703</span>
<span id="704">704</span>
<span id="705">705</span>
<span id="706">706</span>
<span id="707">707</span>
<span id="708">708</span>
<span id="709">709</span>
<span id="710">710</span>
<span id="711">711</span>
<span id="712">712</span>
<span id="713">713</span>
<span id="714">714</span>
<span id="715">715</span>
<span id="716">716</span>
<span id="717">717</span>
<span id="718">718</span>
<span id="719">719</span>
<span id="720">720</span>
<span id="721">721</span>
<span id="722">722</span>
<span id="723">723</span>
<span id="724">724</span>
<span id="725">725</span>
<span id="726">726</span>
<span id="727">727</span>
<span id="728">728</span>
<span id="729">729</span>
<span id="730">730</span>
<span id="731">731</span>
<span id="732">732</span>
<span id="733">733</span>
<span id="734">734</span>
<span id="735">735</span>
<span id="736">736</span>
<span id="737">737</span>
<span id="738">738</span>
<span id="739">739</span>
<span id="740">740</span>
<span id="741">741</span>
<span id="742">742</span>
<span id="743">743</span>
<span id="744">744</span>
<span id="745">745</span>
<span id="746">746</span>
<span id="747">747</span>
<span id="748">748</span>
<span id="749">749</span>
<span id="750">750</span>
<span id="751">751</span>
<span id="752">752</span>
<span id="753">753</span>
<span id="754">754</span>
<span id="755">755</span>
<span id="756">756</span>
<span id="757">757</span>
<span id="758">758</span>
<span id="759">759</span>
<span id="760">760</span>
<span id="761">761</span>
<span id="762">762</span>
<span id="763">763</span>
<span id="764">764</span>
<span id="765">765</span>
<span id="766">766</span>
<span id="767">767</span>
<span id="768">768</span>
<span id="769">769</span>
<span id="770">770</span>
<span id="771">771</span>
<span id="772">772</span>
<span id="773">773</span>
<span id="774">774</span>
<span id="775">775</span>
<span id="776">776</span>
<span id="777">777</span>
<span id="778">778</span>
<span id="779">779</span>
<span id="780">780</span>
<span id="781">781</span>
<span id="782">782</span>
<span id="783">783</span>
<span id="784">784</span>
<span id="785">785</span>
<span id="786">786</span>
</pre><pre class='rust '>
<span class='comment'>//</span>
<span class='comment'>// A rust binding for the GSL library by Guillaume Gomez (guillaume1.gomez@gmail.com)</span>
<span class='comment'>//</span>

<span class='doccomment'>/*! Numerical ODE solvers.

#Ordinary Differential Equations

This chapter describes functions for solving ordinary differential equation (ODE) initial value problems. The library provides a variety of
low-level methods, such as Runge-Kutta and Bulirsch-Stoer routines, and higher-level components for adaptive step-size control. The
components can be combined by the user to achieve the desired solution, with full access to any intermediate steps. A driver object can be
used as a high level wrapper for easy use of low level functions.

##Defining the ODE System

The routines solve the general n-dimensional first-order system,

dy_i(t)/dt = f_i(t, y_1(t), ..., y_n(t))
for i = 1, \dots, n. The stepping functions rely on the vector of derivatives f_i and the Jacobian matrix, J_{ij} = df_i(t,y(t)) / dy_j. A
system of equations is defined using the gsl_odeiv2_system datatype.

##Stepping Functions

The lowest level components are the stepping functions which advance a solution from time t to t+h for a fixed step-size h and estimate
the resulting local error.

##Adaptive Step-size Control

The control function examines the proposed change to the solution produced by a stepping function and attempts to determine the optimal
step-size for a user-specified level of error.

##Evolution

The evolution function combines the results of a stepping function and control function to reliably advance the solution forward one
step using an acceptable step-size.

##Driver

The driver object is a high level wrapper that combines the evolution, control and stepper objects for easy use.

##References and Further Reading

Ascher, U.M., Petzold, L.R., Computer Methods for Ordinary Differential and Differential-Algebraic Equations, SIAM, Philadelphia, 1998.
Hairer, E., Norsett, S. P., Wanner, G., Solving Ordinary Differential Equations I: Nonstiff Problems, Springer, Berlin, 1993.
Hairer, E., Wanner, G., Solving Ordinary Differential Equations II: Stiff and Differential-Algebraic Problems, Springer, Berlin, 1996.
Many of the basic Runge-Kutta formulas can be found in the Handbook of Mathematical Functions,

Abramowitz &amp; Stegun (eds.), Handbook of Mathematical Functions, Section 25.5.
The implicit Bulirsch-Stoer algorithm bsimp is described in the following paper,

G. Bader and P. Deuflhard, “A Semi-Implicit Mid-Point Rule for Stiff Systems of Ordinary Differential Equations.”, Numer. Math. 41,
373–398, 1983.
The Adams and BDF multistep methods msadams and msbdf are based on the following articles,

G. D. Byrne and A. C. Hindmarsh, “A Polyalgorithm for the Numerical Solution of Ordinary Differential Equations.”, ACM Trans. Math.
Software, 1, 71–96, 1975.
P. N. Brown, G. D. Byrne and A. C. Hindmarsh, “VODE: A Variable-coefficient ODE Solver.”, SIAM J. Sci. Stat. Comput. 10, 1038–1051, 1989.
A. C. Hindmarsh, P. N. Brown, K. E. Grant, S. L. Lee, R. Serban, D. E. Shumaker and C. S. Woodward, “SUNDIALS: Suite of Nonlinear and
Differential/Algebraic Equation Solvers.”, ACM Trans. Math. Software 31, 363–396, 2005.
!*/</span>

<span class='kw'>use</span> <span class='ident'>ffi</span>;
<span class='kw'>use</span> <span class='ident'>enums</span>::{<span class='self'>self</span>, <span class='ident'>GSLResult</span>};
<span class='kw'>use</span> <span class='ident'>libc</span>::<span class='ident'>c_void</span>;

<span class='doccomment'>/// Description of a system of ODEs.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// `y&#39; = f(t,y) = dydt(t, y)`</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// The system is specified by giving the right-hand-side of the equation and possibly a jacobian function.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// Some methods require the jacobian function, which calculates the matrix dfdy and the vector dfdt. The matrix dfdy conforms</span>
<span class='doccomment'>/// to the GSL standard, being a continuous range of floating point values, in row-order.</span>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>ODEiv2System</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;</span> {
    <span class='ident'>function</span>: <span class='kw-2'>&amp;</span><span class='lifetime'>&#39;a</span> <span class='kw-2'>mut</span> <span class='ident'>FnMut</span>(<span class='ident'>f64</span>, <span class='kw-2'>&amp;</span>[<span class='ident'>f64</span>], <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> [<span class='ident'>f64</span>]) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span>,
    <span class='ident'>jacobian</span>: <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='kw-2'>&amp;</span><span class='lifetime'>&#39;a</span> <span class='kw-2'>mut</span> <span class='ident'>FnMut</span>(<span class='ident'>f64</span>, <span class='kw-2'>&amp;</span>[<span class='ident'>f64</span>], <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> [<span class='ident'>f64</span>], <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> [<span class='ident'>f64</span>]) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;&gt;</span>,
    <span class='ident'>dimension</span>: <span class='ident'>usize</span>,
}

<span class='kw'>impl</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;</span> <span class='ident'>ODEiv2System</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;</span> {
    <span class='doccomment'>/// Returns a new ODEiv2System with a given dimension and right-hand side.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>new</span>(<span class='ident'>dimension</span>: <span class='ident'>usize</span>,
               <span class='ident'>function</span>: <span class='kw-2'>&amp;</span><span class='lifetime'>&#39;a</span> <span class='kw-2'>mut</span> <span class='ident'>FnMut</span>(<span class='ident'>f64</span>, <span class='kw-2'>&amp;</span>[<span class='ident'>f64</span>], <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> [<span class='ident'>f64</span>])
                        <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span>) <span class='op'>-&gt;</span> <span class='ident'>ODEiv2System</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;</span> {
        <span class='ident'>ODEiv2System</span> {
            <span class='ident'>function</span>: <span class='ident'>function</span>,
            <span class='ident'>jacobian</span>: <span class='prelude-val'>None</span>,
            <span class='ident'>dimension</span>: <span class='ident'>dimension</span>,
        }
    }

    <span class='doccomment'>/// Returns a new ODEiv2System with a jacobian function provided.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>with_jacobian</span>(<span class='ident'>dimension</span>: <span class='ident'>usize</span>,
               <span class='ident'>function</span>: <span class='kw-2'>&amp;</span><span class='lifetime'>&#39;a</span> <span class='kw-2'>mut</span> <span class='ident'>FnMut</span>(<span class='ident'>f64</span>, <span class='kw-2'>&amp;</span>[<span class='ident'>f64</span>], <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> [<span class='ident'>f64</span>])
                        <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span>,
               <span class='ident'>jacobian</span>: <span class='kw-2'>&amp;</span><span class='lifetime'>&#39;a</span> <span class='kw-2'>mut</span> <span class='ident'>FnMut</span>(<span class='ident'>f64</span>, <span class='kw-2'>&amp;</span>[<span class='ident'>f64</span>], <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> [<span class='ident'>f64</span>], <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> [<span class='ident'>f64</span>])
                        <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span>) <span class='op'>-&gt;</span> <span class='ident'>ODEiv2System</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;</span> {
        <span class='ident'>ODEiv2System</span> {
            <span class='ident'>function</span>: <span class='ident'>function</span>,
            <span class='ident'>jacobian</span>: <span class='prelude-val'>Some</span>(<span class='ident'>jacobian</span>),
            <span class='ident'>dimension</span>: <span class='ident'>dimension</span>,
        }
    }

    <span class='doccomment'>/// Return `ffi::gsl_odeiv2_system` structure.</span>
    <span class='kw'>fn</span> <span class='ident'>to_raw</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_system</span> {
        <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_system</span> {
            <span class='ident'>function</span>: <span class='ident'>function_handler</span>,
            <span class='ident'>jacobian</span>: <span class='kw'>if</span> <span class='self'>self</span>.<span class='ident'>jacobian</span>.<span class='ident'>is_some</span>() { <span class='prelude-val'>Some</span>(<span class='ident'>jacobian_handler</span>) } <span class='kw'>else</span> { <span class='prelude-val'>None</span> },
            <span class='ident'>dimension</span>: <span class='self'>self</span>.<span class='ident'>dimension</span>,
            <span class='ident'>params</span>: <span class='self'>self</span> <span class='kw'>as</span> <span class='op'>*</span><span class='kw-2'>mut</span> _ <span class='kw'>as</span> <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>c_void</span>,
        }
    }
}

<span class='doccomment'>/// Default handler for calling the function closure.</span>
<span class='kw'>extern</span> <span class='kw'>fn</span> <span class='ident'>function_handler</span>(<span class='ident'>t</span>: <span class='ident'>f64</span>, <span class='ident'>t_y</span>: <span class='op'>*</span><span class='kw'>const</span> <span class='ident'>f64</span>, <span class='ident'>t_f</span>: <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>f64</span>, <span class='ident'>params</span>: <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>c_void</span>)
        <span class='op'>-&gt;</span> <span class='ident'>enums</span>::<span class='ident'>Value</span> {
    <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>sys</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='op'>*</span>(<span class='ident'>params</span> <span class='kw'>as</span> <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ODEiv2System</span>) };
    <span class='kw'>let</span> <span class='ident'>n</span> <span class='op'>=</span> <span class='ident'>sys</span>.<span class='ident'>dimension</span> <span class='kw'>as</span> <span class='ident'>usize</span>;
    <span class='kw'>let</span> <span class='ident'>t_y</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { ::<span class='ident'>std</span>::<span class='ident'>slice</span>::<span class='ident'>from_raw_parts</span>(<span class='ident'>t_y</span>, <span class='ident'>n</span>) };
    <span class='kw'>let</span> <span class='ident'>t_f</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { ::<span class='ident'>std</span>::<span class='ident'>slice</span>::<span class='ident'>from_raw_parts_mut</span>(<span class='ident'>t_f</span>, <span class='ident'>n</span>) };

    <span class='kw'>match</span> (<span class='ident'>sys</span>.<span class='ident'>function</span>)(<span class='ident'>t</span>, <span class='ident'>t_y</span>, <span class='ident'>t_f</span>) {
        <span class='prelude-val'>Ok</span>(()) <span class='op'>=&gt;</span> <span class='ident'>enums</span>::<span class='ident'>Value</span>::<span class='ident'>Success</span>,
        <span class='prelude-val'>Err</span>(<span class='ident'>e</span>) <span class='op'>=&gt;</span> <span class='ident'>e</span>,
    }
}

<span class='doccomment'>/// Default handler for calling the jacobian closure.</span>
<span class='kw'>extern</span> <span class='kw'>fn</span> <span class='ident'>jacobian_handler</span>(<span class='ident'>t</span>: <span class='ident'>f64</span>, <span class='ident'>t_y</span>: <span class='op'>*</span><span class='kw'>const</span> <span class='ident'>f64</span>, <span class='ident'>t_dfdy</span>: <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>f64</span>, <span class='ident'>t_dfdt</span>: <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>f64</span>,
                           <span class='ident'>params</span>: <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>c_void</span>) <span class='op'>-&gt;</span> <span class='ident'>enums</span>::<span class='ident'>Value</span> {
    <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>sys</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='op'>*</span>(<span class='ident'>params</span> <span class='kw'>as</span> <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ODEiv2System</span>) };
    <span class='kw'>let</span> <span class='ident'>n</span> <span class='op'>=</span> <span class='ident'>sys</span>.<span class='ident'>dimension</span> <span class='kw'>as</span> <span class='ident'>usize</span>;
    <span class='kw'>let</span> <span class='ident'>t_y</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { ::<span class='ident'>std</span>::<span class='ident'>slice</span>::<span class='ident'>from_raw_parts</span>(<span class='ident'>t_y</span>, <span class='ident'>n</span>) };
    <span class='kw'>let</span> <span class='ident'>t_dfdy</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { ::<span class='ident'>std</span>::<span class='ident'>slice</span>::<span class='ident'>from_raw_parts_mut</span>(<span class='ident'>t_dfdy</span>, <span class='ident'>n</span> <span class='op'>*</span> <span class='ident'>n</span>) };
    <span class='kw'>let</span> <span class='ident'>t_dfdt</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { ::<span class='ident'>std</span>::<span class='ident'>slice</span>::<span class='ident'>from_raw_parts_mut</span>(<span class='ident'>t_dfdt</span>, <span class='ident'>n</span>) };

    <span class='kw'>match</span> <span class='ident'>sys</span>.<span class='ident'>jacobian</span> {
        <span class='prelude-val'>Some</span>(<span class='kw-2'>ref</span> <span class='kw-2'>mut</span> <span class='ident'>j</span>) <span class='op'>=&gt;</span>
            <span class='kw'>match</span> <span class='ident'>j</span>(<span class='ident'>t</span>, <span class='ident'>t_y</span>, <span class='ident'>t_dfdy</span>, <span class='ident'>t_dfdt</span>) {
                <span class='prelude-val'>Ok</span>(()) <span class='op'>=&gt;</span> <span class='ident'>enums</span>::<span class='ident'>Value</span>::<span class='ident'>Success</span>,
                <span class='prelude-val'>Err</span>(<span class='ident'>e</span>) <span class='op'>=&gt;</span> <span class='ident'>e</span>,
            },
        <span class='prelude-val'>None</span> <span class='op'>=&gt;</span> <span class='ident'>enums</span>::<span class='ident'>Value</span>::<span class='ident'>BadFunction</span>,
    }
}

<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>ODEiv2Step</span> {
    <span class='ident'>s</span>: <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step</span>
}

<span class='kw'>impl</span> <span class='ident'>ODEiv2Step</span> {
    <span class='doccomment'>/// This function returns a pointer to a newly allocated instance of a stepping function of type T for a system of dim dimensions.</span>
    <span class='doccomment'>/// Please note that if you use a stepper method that requires access to a driver object, it is advisable to use a driver allocation</span>
    <span class='doccomment'>/// method, which automatically allocates a stepper, too.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>new</span>(<span class='ident'>t</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2StepType</span>, <span class='ident'>dim</span>: <span class='ident'>usize</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>ODEiv2Step</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>tmp</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_alloc</span>(<span class='ident'>ffi</span>::<span class='ident'>FFI</span>::<span class='ident'>unwrap</span>(<span class='ident'>t</span>), <span class='ident'>dim</span>) };

        <span class='kw'>if</span> <span class='ident'>tmp</span>.<span class='ident'>is_null</span>() {
            <span class='prelude-val'>None</span>
        } <span class='kw'>else</span> {
            <span class='prelude-val'>Some</span>(<span class='ident'>ODEiv2Step</span> {
                <span class='ident'>s</span>: <span class='ident'>tmp</span>,
            })
        }
    }

    <span class='doccomment'>/// This function resets the stepping function s. It should be used whenever the next use of s will not be a continuation of a previous</span>
    <span class='doccomment'>/// step.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>reset</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span> {
        <span class='ident'>GSLResult</span>::<span class='ident'>from</span>(<span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_reset</span>(<span class='self'>self</span>.<span class='ident'>s</span>) })
    }

    <span class='doccomment'>/// This function returns a pointer to the name of the stepping function. For example,</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// ```Rust</span>
    <span class='doccomment'>/// println!(&quot;step method is &#39;{}&#39;&quot;, s.name().unwrap());</span>
    <span class='doccomment'>/// ```</span>
    <span class='doccomment'>/// would print something like step method is &#39;rkf45&#39;.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>name</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>String</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>tmp</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_name</span>(<span class='self'>self</span>.<span class='ident'>s</span>) };

        <span class='kw'>if</span> <span class='ident'>tmp</span>.<span class='ident'>is_null</span>() {
            <span class='prelude-val'>None</span>
        } <span class='kw'>else</span> {
            <span class='kw'>unsafe</span> { <span class='prelude-val'>Some</span>(<span class='ident'>String</span>::<span class='ident'>from_utf8_lossy</span>(::<span class='ident'>std</span>::<span class='ident'>ffi</span>::<span class='ident'>CStr</span>::<span class='ident'>from_ptr</span>(<span class='ident'>tmp</span>).<span class='ident'>to_bytes</span>()).<span class='ident'>to_string</span>()) }
        }
    }

    <span class='doccomment'>/// This function returns the order of the stepping function on the previous step. The order can vary if the stepping function itself is</span>
    <span class='doccomment'>/// adaptive.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>order</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>u32</span> {
        <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_order</span>(<span class='self'>self</span>.<span class='ident'>s</span>) }
    }

    <span class='doccomment'>/// This function sets a pointer of the driver object d for stepper s, to allow the stepper to access control (and evolve) object through</span>
    <span class='doccomment'>/// the driver object. This is a requirement for some steppers, to get the desired error level for internal iteration of stepper.</span>
    <span class='doccomment'>/// Allocation of a driver object calls this function automatically.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>set_driver</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>d</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2Driver</span>) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span> {
        <span class='ident'>GSLResult</span>::<span class='ident'>from</span>(<span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_set_driver</span>(<span class='self'>self</span>.<span class='ident'>s</span>, <span class='ident'>d</span>.<span class='ident'>d</span>) })
    }

    <span class='doccomment'>/// This function applies the stepping function s to the system of equations defined by sys, using the step-size h to advance the system</span>
    <span class='doccomment'>/// from time t and state y to time t+h. The new state of the system is stored in y on output, with an estimate of the absolute error</span>
    <span class='doccomment'>/// in each component stored in yerr. If the argument dydt_in is not null it should point an array containing the derivatives for the</span>
    <span class='doccomment'>/// system at time t on input. This is optional as the derivatives will be computed internally if they are not provided, but allows</span>
    <span class='doccomment'>/// the reuse of existing derivative information. On output the new derivatives of the system at time t+h will be stored in dydt_out</span>
    <span class='doccomment'>/// if it is not null.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// The stepping function returns enums::value::Failure if it is unable to compute the requested step. Also, if the user-supplied functions defined</span>
    <span class='doccomment'>/// in the system sys return a status other than ::Value::Success the step will be aborted. In that case, the elements of y will be restored</span>
    <span class='doccomment'>/// to their pre-step values and the error code from the user-supplied function will be returned. Failure may be due to a singularity in</span>
    <span class='doccomment'>/// the system or too large step-size h. In that case the step should be attempted again with a smaller step-size, e.g. h/2.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// If the driver object is not appropriately set via gsl_odeiv2_step_set_driver for those steppers that need it, the stepping function</span>
    <span class='doccomment'>/// returns ::Fault. If the user-supplied functions defined in the system sys returns enums::value::BadFunc, the function returns</span>
    <span class='doccomment'>/// immediately with the same return code. In this case the user must call gsl_odeiv2_step_reset before calling this function again.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>apply</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>t</span>: <span class='ident'>f64</span>, <span class='ident'>h</span>: <span class='ident'>f64</span>, <span class='ident'>y</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> [<span class='ident'>f64</span>], <span class='ident'>yerr</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> [<span class='ident'>f64</span>], <span class='ident'>dydt_in</span>: <span class='kw-2'>&amp;</span>[<span class='ident'>f64</span>], <span class='ident'>dydt_out</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> [<span class='ident'>f64</span>],
        <span class='ident'>sys</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ODEiv2System</span>) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>sys_raw</span> <span class='op'>=</span> <span class='ident'>sys</span>.<span class='ident'>to_raw</span>();
        <span class='kw'>let</span> <span class='ident'>r</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_apply</span>(<span class='self'>self</span>.<span class='ident'>s</span>, <span class='ident'>t</span>, <span class='ident'>h</span>, <span class='ident'>y</span>.<span class='ident'>as_mut_ptr</span>(), <span class='ident'>yerr</span>.<span class='ident'>as_mut_ptr</span>(), <span class='ident'>dydt_in</span>.<span class='ident'>as_ptr</span>(), <span class='ident'>dydt_out</span>.<span class='ident'>as_mut_ptr</span>(),
            <span class='kw-2'>&amp;</span><span class='ident'>sys_raw</span> <span class='kw'>as</span> <span class='op'>*</span><span class='kw'>const</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_system</span>) };
        <span class='ident'>GSLResult</span>::<span class='ident'>from</span>(<span class='ident'>r</span>)
    }
}

<span class='kw'>impl</span> <span class='ident'>Drop</span> <span class='kw'>for</span> <span class='ident'>ODEiv2Step</span> {
    <span class='kw'>fn</span> <span class='ident'>drop</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) {
        <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_free</span>(<span class='self'>self</span>.<span class='ident'>s</span>) };
        <span class='self'>self</span>.<span class='ident'>s</span> <span class='op'>=</span> ::<span class='ident'>std</span>::<span class='ident'>ptr</span>::<span class='ident'>null_mut</span>();
    }
}

<span class='kw'>impl</span> <span class='ident'>ffi</span>::<span class='ident'>FFI</span><span class='op'>&lt;</span><span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step</span><span class='op'>&gt;</span> <span class='kw'>for</span> <span class='ident'>ODEiv2Step</span> {
    <span class='kw'>fn</span> <span class='ident'>wrap</span>(<span class='ident'>s</span>: <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step</span>) <span class='op'>-&gt;</span> <span class='ident'>ODEiv2Step</span> {
        <span class='ident'>ODEiv2Step</span> {
            <span class='ident'>s</span>: <span class='ident'>s</span>
        }
    }

    <span class='kw'>fn</span> <span class='ident'>unwrap</span>(<span class='ident'>s</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2Step</span>) <span class='op'>-&gt;</span> <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step</span> {
        <span class='ident'>s</span>.<span class='ident'>s</span>
    }
}

<span class='attribute'>#[<span class='ident'>derive</span>(<span class='ident'>Clone</span>, <span class='ident'>Copy</span>)]</span>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>ODEiv2StepType</span> {
    <span class='ident'>t</span>: <span class='op'>*</span><span class='kw'>const</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_type</span>
}

<span class='kw'>impl</span> <span class='ident'>ODEiv2StepType</span> {
    <span class='doccomment'>/// Explicit embedded Runge-Kutta (2, 3) method.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>rk2</span>() <span class='op'>-&gt;</span> <span class='ident'>ODEiv2StepType</span> {
        <span class='ident'>ODEiv2StepType</span> {
            <span class='ident'>t</span>: <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_rk2</span>
        }
    }

    <span class='doccomment'>/// Explicit 4th order (classical) Runge-Kutta. Error estimation is carried out by the step doubling method. For more efficient</span>
    <span class='doccomment'>/// estimate of the error, use the embedded methods described below.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>rk4</span>() <span class='op'>-&gt;</span> <span class='ident'>ODEiv2StepType</span> {
        <span class='ident'>ODEiv2StepType</span> {
            <span class='ident'>t</span>: <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_rk4</span>
        }
    }

    <span class='doccomment'>/// Explicit embedded Runge-Kutta-Fehlberg (4, 5) method. This method is a good general-purpose integrator.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>rk45</span>() <span class='op'>-&gt;</span> <span class='ident'>ODEiv2StepType</span> {
        <span class='ident'>ODEiv2StepType</span> {
            <span class='ident'>t</span>: <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_rkf45</span>
        }
    }

    <span class='doccomment'>/// Explicit embedded Runge-Kutta Cash-Karp (4, 5) method.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>rkck</span>() <span class='op'>-&gt;</span> <span class='ident'>ODEiv2StepType</span> {
        <span class='ident'>ODEiv2StepType</span> {
            <span class='ident'>t</span>: <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_rkck</span>
        }
    }

    <span class='doccomment'>/// Explicit embedded Runge-Kutta Prince-Dormand (8, 9) method.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>rk8pd</span>() <span class='op'>-&gt;</span> <span class='ident'>ODEiv2StepType</span> {
        <span class='ident'>ODEiv2StepType</span> {
            <span class='ident'>t</span>: <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_rk8pd</span>
        }
    }

    <span class='doccomment'>/// Implicit Gaussian first order Runge-Kutta. Also known as implicit Euler or backward Euler method. Error estimation is carried out by</span>
    <span class='doccomment'>/// the step doubling method. This algorithm requires the Jacobian and access to the driver object via gsl_odeiv2_step_set_driver.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>rk1imp</span>() <span class='op'>-&gt;</span> <span class='ident'>ODEiv2StepType</span> {
        <span class='ident'>ODEiv2StepType</span> {
            <span class='ident'>t</span>: <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_rk1imp</span>
        }
    }

    <span class='doccomment'>/// Implicit Gaussian second order Runge-Kutta. Also known as implicit mid-point rule. Error estimation is carried out by the step doubling</span>
    <span class='doccomment'>/// method. This stepper requires the Jacobian and access to the driver object via gsl_odeiv2_step_set_driver.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>rk2imp</span>() <span class='op'>-&gt;</span> <span class='ident'>ODEiv2StepType</span> {
        <span class='ident'>ODEiv2StepType</span> {
            <span class='ident'>t</span>: <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_rk2imp</span>
        }
    }

    <span class='doccomment'>/// Implicit Gaussian 4th order Runge-Kutta. Error estimation is carried out by the step doubling method. This algorithm requires the</span>
    <span class='doccomment'>/// Jacobian and access to the driver object via gsl_odeiv2_step_set_driver.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>rk4imp</span>() <span class='op'>-&gt;</span> <span class='ident'>ODEiv2StepType</span> {
        <span class='ident'>ODEiv2StepType</span> {
            <span class='ident'>t</span>: <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_rk4imp</span>
        }
    }

    <span class='doccomment'>/// Implicit Bulirsch-Stoer method of Bader and Deuflhard. The method is generally suitable for stiff problems. This stepper requires</span>
    <span class='doccomment'>/// the Jacobian.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>bsimp</span>() <span class='op'>-&gt;</span> <span class='ident'>ODEiv2StepType</span> {
        <span class='ident'>ODEiv2StepType</span> {
            <span class='ident'>t</span>: <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_bsimp</span>
        }
    }

    <span class='doccomment'>/// A variable-coefficient linear multistep Adams method in Nordsieck form. This stepper uses explicit Adams-Bashforth (predictor) and</span>
    <span class='doccomment'>/// implicit Adams-Moulton (corrector) methods in P(EC)^m functional iteration mode. Method order varies dynamically between 1 and 12.</span>
    <span class='doccomment'>/// This stepper requires the access to the driver object via gsl_odeiv2_step_set_driver.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>msadams</span>() <span class='op'>-&gt;</span> <span class='ident'>ODEiv2StepType</span> {
        <span class='ident'>ODEiv2StepType</span> {
            <span class='ident'>t</span>: <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_msadams</span>
        }
    }

    <span class='doccomment'>/// A variable-coefficient linear multistep backward differentiation formula (BDF) method in Nordsieck form. This stepper uses the explicit</span>
    <span class='doccomment'>/// BDF formula as predictor and implicit BDF formula as corrector. A modified Newton iteration method is used to solve the system of</span>
    <span class='doccomment'>/// non-linear equations. Method order varies dynamically between 1 and 5. The method is generally suitable for stiff problems. This</span>
    <span class='doccomment'>/// stepper requires the Jacobian and the access to the driver object via gsl_odeiv2_step_set_driver.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>msbdf</span>() <span class='op'>-&gt;</span> <span class='ident'>ODEiv2StepType</span> {
        <span class='ident'>ODEiv2StepType</span> {
            <span class='ident'>t</span>: <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_msbdf</span>
        }
    }
}

<span class='kw'>impl</span> <span class='ident'>ffi</span>::<span class='ident'>FFI</span><span class='op'>&lt;</span><span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_type</span><span class='op'>&gt;</span> <span class='kw'>for</span> <span class='ident'>ODEiv2StepType</span> {
    <span class='kw'>fn</span> <span class='ident'>wrap</span>(<span class='ident'>t</span>: <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_type</span>) <span class='op'>-&gt;</span> <span class='ident'>ODEiv2StepType</span> {
        <span class='ident'>ODEiv2StepType</span> {
            <span class='ident'>t</span>: <span class='ident'>t</span>
        }
    }

    <span class='kw'>fn</span> <span class='ident'>unwrap</span>(<span class='ident'>t</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2StepType</span>) <span class='op'>-&gt;</span> <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_type</span> {
        <span class='ident'>t</span>.<span class='ident'>t</span> <span class='kw'>as</span> <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_step_type</span>
    }
}

<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>ODEiv2Control</span> {
    <span class='ident'>c</span>: <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control</span>
}

<span class='kw'>impl</span> <span class='ident'>ODEiv2Control</span> {
    <span class='doccomment'>/// The standard control object is a four parameter heuristic based on absolute and relative errors eps_abs and eps_rel, and scaling</span>
    <span class='doccomment'>/// factors a_y and a_dydt for the system state y(t) and derivatives y&#39;(t) respectively.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// The step-size adjustment procedure for this method begins by computing the desired error level D_i for each component,</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// D_i = eps_abs + eps_rel * (a_y |y_i| + a_dydt h |y\prime_i|)</span>
    <span class='doccomment'>/// and comparing it with the observed error E_i = |yerr_i|. If the observed error E exceeds the desired error level D by more than</span>
    <span class='doccomment'>/// 10% for any component then the method reduces the step-size by an appropriate factor,</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// h_new = h_old * S * (E/D)^(-1/q)</span>
    <span class='doccomment'>/// where q is the consistency order of the method (e.g. q=4 for 4(5) embedded RK), and S is a safety factor of 0.9. The ratio E/D is</span>
    <span class='doccomment'>/// taken to be the maximum of the ratios E_i/D_i.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// If the observed error E is less than 50% of the desired error level D for the maximum ratio E_i/D_i then the algorithm takes the</span>
    <span class='doccomment'>/// opportunity to increase the step-size to bring the error in line with the desired level,</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// h_new = h_old * S * (E/D)^(-1/(q+1))</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// This encompasses all the standard error scaling methods. To avoid uncontrolled changes in the stepsize, the overall scaling factor</span>
    <span class='doccomment'>/// is limited to the range 1/5 to 5.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>standard_new</span>(<span class='ident'>eps_abs</span>: <span class='ident'>f64</span>, <span class='ident'>eps_rel</span>: <span class='ident'>f64</span>, <span class='ident'>a_y</span>: <span class='ident'>f64</span>, <span class='ident'>a_dydt</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>ODEiv2Control</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>tmp</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_standard_new</span>(<span class='ident'>eps_abs</span>, <span class='ident'>eps_rel</span>, <span class='ident'>a_y</span>, <span class='ident'>a_dydt</span>) };

        <span class='kw'>if</span> <span class='ident'>tmp</span>.<span class='ident'>is_null</span>() {
            <span class='prelude-val'>None</span>
        } <span class='kw'>else</span> {
            <span class='prelude-val'>Some</span>(<span class='ident'>ODEiv2Control</span> {
                <span class='ident'>c</span>: <span class='ident'>tmp</span>
            })
        }
    }

    <span class='doccomment'>/// This function creates a new control object which will keep the local error on each step within an absolute error of eps_abs and relative</span>
    <span class='doccomment'>/// error of eps_rel with respect to the solution y_i(t). This is equivalent to the standard control object with a_y=1 and a_dydt=0.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>y_new</span>(<span class='ident'>eps_abs</span>: <span class='ident'>f64</span>, <span class='ident'>eps_rel</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>ODEiv2Control</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>tmp</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_y_new</span>(<span class='ident'>eps_abs</span>, <span class='ident'>eps_rel</span>) };

        <span class='kw'>if</span> <span class='ident'>tmp</span>.<span class='ident'>is_null</span>() {
            <span class='prelude-val'>None</span>
        } <span class='kw'>else</span> {
            <span class='prelude-val'>Some</span>(<span class='ident'>ODEiv2Control</span> {
                <span class='ident'>c</span>: <span class='ident'>tmp</span>
            })
        }
    }

    <span class='doccomment'>/// This function creates a new control object which will keep the local error on each step within an absolute error of eps_abs and relative</span>
    <span class='doccomment'>/// error of eps_rel with respect to the derivatives of the solution y&#39;_i(t). This is equivalent to the standard control object with</span>
    <span class='doccomment'>/// a_y=0 and a_dydt=1.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>yp_new</span>(<span class='ident'>eps_abs</span>: <span class='ident'>f64</span>, <span class='ident'>eps_rel</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>ODEiv2Control</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>tmp</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_yp_new</span>(<span class='ident'>eps_abs</span>, <span class='ident'>eps_rel</span>) };

        <span class='kw'>if</span> <span class='ident'>tmp</span>.<span class='ident'>is_null</span>() {
            <span class='prelude-val'>None</span>
        } <span class='kw'>else</span> {
            <span class='prelude-val'>Some</span>(<span class='ident'>ODEiv2Control</span> {
                <span class='ident'>c</span>: <span class='ident'>tmp</span>
            })
        }
    }

    <span class='doccomment'>/// This function creates a new control object which uses the same algorithm as gsl_odeiv2_control_standard_new but with an absolute error</span>
    <span class='doccomment'>/// which is scaled for each component by the array scale_abs. The formula for D_i for this control object is,</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// D_i = eps_abs * s_i + eps_rel * (a_y |y_i| + a_dydt h |y\prime_i|)</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// where s_i is the i-th component of the array scale_abs. The same error control heuristic is used by the Matlab ODE suite.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>scaled_new</span>(<span class='ident'>eps_abs</span>: <span class='ident'>f64</span>, <span class='ident'>eps_rel</span>: <span class='ident'>f64</span>, <span class='ident'>a_y</span>: <span class='ident'>f64</span>, <span class='ident'>a_dydt</span>: <span class='ident'>f64</span>, <span class='ident'>scale_abs</span>: <span class='kw-2'>&amp;</span>[<span class='ident'>f64</span>]) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>ODEiv2Control</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>tmp</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_scaled_new</span>(<span class='ident'>eps_abs</span>, <span class='ident'>eps_rel</span>, <span class='ident'>a_y</span>, <span class='ident'>a_dydt</span>, <span class='ident'>scale_abs</span>.<span class='ident'>as_ptr</span>(), <span class='ident'>scale_abs</span>.<span class='ident'>len</span>() <span class='kw'>as</span> <span class='ident'>usize</span>) };

        <span class='kw'>if</span> <span class='ident'>tmp</span>.<span class='ident'>is_null</span>() {
            <span class='prelude-val'>None</span>
        } <span class='kw'>else</span> {
            <span class='prelude-val'>Some</span>(<span class='ident'>ODEiv2Control</span> {
                <span class='ident'>c</span>: <span class='ident'>tmp</span>
            })
        }
    }

    <span class='doccomment'>/// This function returns a pointer to a newly allocated instance of a control function of type T. This function is only needed for</span>
    <span class='doccomment'>/// defining new types of control functions. For most purposes the standard control functions described above should be sufficient.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>alloc</span>(<span class='ident'>t</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2ControlType</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>ODEiv2Control</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>tmp</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_alloc</span>(<span class='ident'>ffi</span>::<span class='ident'>FFI</span>::<span class='ident'>unwrap</span>(<span class='ident'>t</span>)) };

        <span class='kw'>if</span> <span class='ident'>tmp</span>.<span class='ident'>is_null</span>() {
            <span class='prelude-val'>None</span>
        } <span class='kw'>else</span> {
            <span class='prelude-val'>Some</span>(<span class='ident'>ODEiv2Control</span> {
                <span class='ident'>c</span>: <span class='ident'>tmp</span>
            })
        }
    }

    <span class='doccomment'>/// This function initializes the control function c with the parameters eps_abs (absolute error), eps_rel (relative error), a_y</span>
    <span class='doccomment'>/// (scaling factor for y) and a_dydt (scaling factor for derivatives).</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>init</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>eps_abs</span>: <span class='ident'>f64</span>, <span class='ident'>eps_rel</span>: <span class='ident'>f64</span>, <span class='ident'>a_y</span>: <span class='ident'>f64</span>, <span class='ident'>a_dydt</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span> {
        <span class='ident'>GSLResult</span>::<span class='ident'>from</span>(<span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_init</span>(<span class='self'>self</span>.<span class='ident'>c</span>, <span class='ident'>eps_abs</span>, <span class='ident'>eps_rel</span>, <span class='ident'>a_y</span>, <span class='ident'>a_dydt</span>) })
    }

    <span class='doccomment'>/// This function adjusts the step-size h using the control function c, and the current values of y, yerr and dydt. The stepping function</span>
    <span class='doccomment'>/// step is also needed to determine the order of the method. If the error in the y-values yerr is found to be too large then the step-size</span>
    <span class='doccomment'>/// h is reduced and the function returns ODEiv::Dec. If the error is sufficiently small then h may be increased and</span>
    <span class='doccomment'>/// ODEiv::Inc is returned. The function returns ODEiv::Nil if the step-size is unchanged. The goal of the function is to estimate</span>
    <span class='doccomment'>/// the largest step-size which satisfies the user-specified accuracy requirements for the current point.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>hadjust</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>s</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2Step</span>, <span class='ident'>y</span>: <span class='kw-2'>&amp;</span>[<span class='ident'>f64</span>], <span class='ident'>yerr</span>: <span class='kw-2'>&amp;</span>[<span class='ident'>f64</span>], <span class='ident'>dydt</span>: <span class='kw-2'>&amp;</span>[<span class='ident'>f64</span>], <span class='ident'>h</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>f64</span>) <span class='op'>-&gt;</span> ::<span class='ident'>ODEiv</span> {
        <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_hadjust</span>(<span class='self'>self</span>.<span class='ident'>c</span>, <span class='ident'>s</span>.<span class='ident'>s</span>, <span class='ident'>y</span>.<span class='ident'>as_ptr</span>(), <span class='ident'>yerr</span>.<span class='ident'>as_ptr</span>(), <span class='ident'>dydt</span>.<span class='ident'>as_ptr</span>(), <span class='ident'>h</span>) }
    }

    <span class='doccomment'>/// This function returns a pointer to the name of the control function. For example,</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// ```Rust</span>
    <span class='doccomment'>/// println!(&quot;control method is &#39;{}&#39;&quot;, c.name());</span>
    <span class='doccomment'>/// ```</span>
    <span class='doccomment'>/// would print something like control method is &#39;standard&#39;</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>name</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>String</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>tmp</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_name</span>(<span class='self'>self</span>.<span class='ident'>c</span>) };

        <span class='kw'>if</span> <span class='ident'>tmp</span>.<span class='ident'>is_null</span>() {
            <span class='prelude-val'>None</span>
        } <span class='kw'>else</span> {
            <span class='kw'>unsafe</span> { <span class='prelude-val'>Some</span>(<span class='ident'>String</span>::<span class='ident'>from_utf8_lossy</span>(::<span class='ident'>std</span>::<span class='ident'>ffi</span>::<span class='ident'>CStr</span>::<span class='ident'>from_ptr</span>(<span class='ident'>tmp</span>).<span class='ident'>to_bytes</span>()).<span class='ident'>to_string</span>()) }
        }
    }

    <span class='doccomment'>/// This function calculates the desired error level of the ind-th component to errlev. It requires the value (y) and value of the derivative</span>
    <span class='doccomment'>/// (dydt) of the component, and the current step size h.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>errlevel</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>y</span>: <span class='ident'>f64</span>, <span class='ident'>dydt</span>: <span class='ident'>f64</span>, <span class='ident'>h</span>: <span class='ident'>f64</span>, <span class='ident'>ind</span>: <span class='ident'>usize</span>, <span class='ident'>errlev</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span> {
        <span class='ident'>GSLResult</span>::<span class='ident'>from</span>(<span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_errlevel</span>(<span class='self'>self</span>.<span class='ident'>c</span>, <span class='ident'>y</span>, <span class='ident'>dydt</span>, <span class='ident'>h</span>, <span class='ident'>ind</span>, <span class='ident'>errlev</span>) })
    }

    <span class='doccomment'>/// This function sets a pointer of the driver object d for control object c.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>set_driver</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>d</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2Driver</span>) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span> {
        <span class='ident'>GSLResult</span>::<span class='ident'>from</span>(<span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_set_driver</span>(<span class='self'>self</span>.<span class='ident'>c</span>, <span class='ident'>d</span>.<span class='ident'>d</span>) })
    }
}

<span class='kw'>impl</span> <span class='ident'>Drop</span> <span class='kw'>for</span> <span class='ident'>ODEiv2Control</span> {
    <span class='kw'>fn</span> <span class='ident'>drop</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) {
        <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_free</span>(<span class='self'>self</span>.<span class='ident'>c</span>) };
        <span class='self'>self</span>.<span class='ident'>c</span> <span class='op'>=</span> ::<span class='ident'>std</span>::<span class='ident'>ptr</span>::<span class='ident'>null_mut</span>();
    }
}

<span class='kw'>impl</span> <span class='ident'>ffi</span>::<span class='ident'>FFI</span><span class='op'>&lt;</span><span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control</span><span class='op'>&gt;</span> <span class='kw'>for</span> <span class='ident'>ODEiv2Control</span> {
    <span class='kw'>fn</span> <span class='ident'>wrap</span>(<span class='ident'>c</span>: <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control</span>) <span class='op'>-&gt;</span> <span class='ident'>ODEiv2Control</span> {
        <span class='ident'>ODEiv2Control</span> {
            <span class='ident'>c</span>: <span class='ident'>c</span>
        }
    }

    <span class='kw'>fn</span> <span class='ident'>unwrap</span>(<span class='ident'>c</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2Control</span>) <span class='op'>-&gt;</span> <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control</span> {
        <span class='ident'>c</span>.<span class='ident'>c</span>
    }
}

<span class='attribute'>#[<span class='ident'>derive</span>(<span class='ident'>Clone</span>, <span class='ident'>Copy</span>)]</span>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>ODEiv2ControlType</span> {
    <span class='ident'>t</span>: <span class='op'>*</span><span class='kw'>const</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_type</span>
}

<span class='kw'>impl</span> <span class='ident'>ODEiv2ControlType</span> {
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>scaled</span>() <span class='op'>-&gt;</span> <span class='ident'>ODEiv2ControlType</span> {
        <span class='ident'>ODEiv2ControlType</span> {
            <span class='ident'>t</span>: <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_scaled</span>
        }
    }

    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>standard</span>() <span class='op'>-&gt;</span> <span class='ident'>ODEiv2ControlType</span> {
        <span class='ident'>ODEiv2ControlType</span> {
            <span class='ident'>t</span>: <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_standard</span>
        }
    }
}

<span class='kw'>impl</span> <span class='ident'>ffi</span>::<span class='ident'>FFI</span><span class='op'>&lt;</span><span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_type</span><span class='op'>&gt;</span> <span class='kw'>for</span> <span class='ident'>ODEiv2ControlType</span> {
    <span class='kw'>fn</span> <span class='ident'>wrap</span>(<span class='ident'>t</span>: <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_type</span>) <span class='op'>-&gt;</span> <span class='ident'>ODEiv2ControlType</span> {
        <span class='ident'>ODEiv2ControlType</span> {
            <span class='ident'>t</span>: <span class='ident'>t</span>
        }
    }

    <span class='kw'>fn</span> <span class='ident'>unwrap</span>(<span class='ident'>t</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2ControlType</span>) <span class='op'>-&gt;</span> <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_type</span> {
        <span class='ident'>t</span>.<span class='ident'>t</span> <span class='kw'>as</span> <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_control_type</span>
    }
}

<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>ODEiv2Evolve</span> {
    <span class='ident'>e</span>: <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_evolve</span>
}

<span class='kw'>impl</span> <span class='ident'>ODEiv2Evolve</span> {
    <span class='doccomment'>/// This function returns a pointer to a newly allocated instance of an evolution function for a system of dim dimensions.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>new</span>(<span class='ident'>dim</span>: <span class='ident'>usize</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>ODEiv2Evolve</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>tmp</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_evolve_alloc</span>(<span class='ident'>dim</span>) };

        <span class='kw'>if</span> <span class='ident'>tmp</span>.<span class='ident'>is_null</span>() {
            <span class='prelude-val'>None</span>
        } <span class='kw'>else</span> {
            <span class='prelude-val'>Some</span>(<span class='ident'>ODEiv2Evolve</span> {
                <span class='ident'>e</span>: <span class='ident'>tmp</span>
            })
        }
    }

    <span class='doccomment'>/// This function advances the system (e, sys) from time t and position y using the stepping function step. The new time and position</span>
    <span class='doccomment'>/// are stored in t and y on output.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// The initial step-size is taken as h. The control function con is applied to check whether the local error estimated by the stepping</span>
    <span class='doccomment'>/// function step using step-size h exceeds the required error tolerance. If the error is too high, the step is retried by calling step</span>
    <span class='doccomment'>/// with a decreased step-size. This process is continued until an acceptable step-size is found. An estimate of the local error for</span>
    <span class='doccomment'>/// the step can be obtained from the components of the array e-&gt;yerr[].</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// If the user-supplied functions defined in the system sys returns enums::value::BadFunc, the function returns immediately with the same</span>
    <span class='doccomment'>/// return code. In this case the user must call gsl_odeiv2_step_reset and gsl_odeiv2_evolve_reset before calling this function again.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Otherwise, if the user-supplied functions defined in the system sys or the stepping function step return a status other than</span>
    <span class='doccomment'>/// ::Value::Success, the step is retried with a decreased step-size. If the step-size decreases below machine precision, a status of</span>
    <span class='doccomment'>/// ::Failuer is returned if the user functions returned ::Value::Success. Otherwise the value returned by user function is returned.</span>
    <span class='doccomment'>/// If no acceptable step can be made, t and y will be restored to their pre-step values and h contains the final attempted step-size.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// If the step is successful the function returns a suggested step-size for the next step in h. The maximum time t1 is guaranteed not</span>
    <span class='doccomment'>/// to be exceeded by the time-step. On the final time-step the value of t will be set to t1 exactly.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>apply</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>c</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2Control</span>, <span class='ident'>s</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2Step</span>, <span class='ident'>sys</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ODEiv2System</span>, <span class='ident'>t</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>f64</span>, <span class='ident'>t1</span>: <span class='ident'>f64</span>, <span class='ident'>h</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>f64</span>,
        <span class='ident'>y</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> [<span class='ident'>f64</span>]) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>sys_raw</span> <span class='op'>=</span> <span class='ident'>sys</span>.<span class='ident'>to_raw</span>();
        <span class='kw'>let</span> <span class='ident'>psys</span> <span class='op'>=</span> <span class='kw-2'>&amp;</span><span class='ident'>sys_raw</span> <span class='kw'>as</span> <span class='op'>*</span><span class='kw'>const</span> _;
        <span class='ident'>GSLResult</span>::<span class='ident'>from</span>(<span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_evolve_apply</span>(<span class='self'>self</span>.<span class='ident'>e</span>, <span class='ident'>c</span>.<span class='ident'>c</span>, <span class='ident'>s</span>.<span class='ident'>s</span>, <span class='ident'>psys</span>, <span class='ident'>t</span>, <span class='ident'>t1</span>, <span class='ident'>h</span>, <span class='ident'>y</span>.<span class='ident'>as_mut_ptr</span>()) })
    }

    <span class='doccomment'>/// This function advances the ODE-system (e, sys, con) from time t and position y using the stepping function step by a specified step</span>
    <span class='doccomment'>/// size h. If the local error estimated by the stepping function exceeds the desired error level, the step is not taken and the function</span>
    <span class='doccomment'>/// returns enums::value::Failure. Otherwise the value returned by user function is returned.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>apply_fixed_step</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>c</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2Control</span>, <span class='ident'>s</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2Step</span>, <span class='ident'>sys</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ODEiv2System</span>, <span class='ident'>t</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>f64</span>, <span class='ident'>h</span>: <span class='ident'>f64</span>,
        <span class='ident'>y</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> [<span class='ident'>f64</span>]) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>sys_raw</span> <span class='op'>=</span> <span class='ident'>sys</span>.<span class='ident'>to_raw</span>();
        <span class='kw'>let</span> <span class='ident'>psys</span> <span class='op'>=</span> <span class='kw-2'>&amp;</span><span class='ident'>sys_raw</span> <span class='kw'>as</span> <span class='op'>*</span><span class='kw'>const</span> _;
        <span class='ident'>GSLResult</span>::<span class='ident'>from</span>(<span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_evolve_apply_fixed_step</span>(<span class='self'>self</span>.<span class='ident'>e</span>, <span class='ident'>c</span>.<span class='ident'>c</span>, <span class='ident'>s</span>.<span class='ident'>s</span>, <span class='ident'>psys</span>, <span class='ident'>t</span>, <span class='ident'>h</span>, <span class='ident'>y</span>.<span class='ident'>as_mut_ptr</span>()) })
    }

    <span class='doccomment'>/// This function resets the evolution function e. It should be used whenever the next use of e will not be a continuation of a previous</span>
    <span class='doccomment'>/// step.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>reset</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span> {
        <span class='ident'>GSLResult</span>::<span class='ident'>from</span>(<span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_evolve_reset</span>(<span class='self'>self</span>.<span class='ident'>e</span>) })
    }

    <span class='doccomment'>/// This function sets a pointer of the driver object d for evolve object e.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// If a system has discontinuous changes in the derivatives at known points, it is advisable to evolve the system between each discontinuity</span>
    <span class='doccomment'>/// in sequence. For example, if a step-change in an external driving force occurs at times t_a, t_b and t_c then evolution should be carried</span>
    <span class='doccomment'>/// out over the ranges (t_0,t_a), (t_a,t_b), (t_b,t_c), and (t_c,t_1) separately and not directly over the range (t_0,t_1).</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>set_driver</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>d</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2Driver</span>) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span> {
        <span class='ident'>GSLResult</span>::<span class='ident'>from</span>(<span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_evolve_set_driver</span>(<span class='self'>self</span>.<span class='ident'>e</span>, <span class='ident'>d</span>.<span class='ident'>d</span>) })
    }
}

<span class='kw'>impl</span> <span class='ident'>Drop</span> <span class='kw'>for</span> <span class='ident'>ODEiv2Evolve</span> {
    <span class='kw'>fn</span> <span class='ident'>drop</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) {
        <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_evolve_free</span>(<span class='self'>self</span>.<span class='ident'>e</span>) };
        <span class='self'>self</span>.<span class='ident'>e</span> <span class='op'>=</span> ::<span class='ident'>std</span>::<span class='ident'>ptr</span>::<span class='ident'>null_mut</span>();
    }
}

<span class='kw'>impl</span> <span class='ident'>ffi</span>::<span class='ident'>FFI</span><span class='op'>&lt;</span><span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_evolve</span><span class='op'>&gt;</span> <span class='kw'>for</span> <span class='ident'>ODEiv2Evolve</span> {
    <span class='kw'>fn</span> <span class='ident'>wrap</span>(<span class='ident'>e</span>: <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_evolve</span>) <span class='op'>-&gt;</span> <span class='ident'>ODEiv2Evolve</span> {
        <span class='ident'>ODEiv2Evolve</span> {
            <span class='ident'>e</span>: <span class='ident'>e</span>
        }
    }

    <span class='kw'>fn</span> <span class='ident'>unwrap</span>(<span class='ident'>e</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2Evolve</span>) <span class='op'>-&gt;</span> <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_evolve</span> {
        <span class='ident'>e</span>.<span class='ident'>e</span>
    }
}

<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>ODEiv2Driver</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;</span> {
    <span class='ident'>d</span>: <span class='op'>*</span><span class='kw-2'>mut</span> <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_driver</span>,
    <span class='doccomment'>/// `ffi::gsl_odeiv2_system` provided when constructing `d`.</span>
    <span class='attribute'>#[<span class='ident'>allow</span>(<span class='ident'>dead_code</span>)]</span>
    <span class='ident'>raw_system</span>: <span class='ident'>Box</span><span class='op'>&lt;</span><span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_system</span><span class='op'>&gt;</span>,
    <span class='doccomment'>/// `PhantomData` to bind lifetime of this struct to the lifetime</span>
    <span class='doccomment'>/// of the provided ODEiv2System.</span>
    <span class='ident'>phantom</span>: ::<span class='ident'>std</span>::<span class='ident'>marker</span>::<span class='ident'>PhantomData</span><span class='op'>&lt;</span><span class='kw-2'>&amp;</span><span class='lifetime'>&#39;a</span> <span class='ident'>ODEiv2System</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;&gt;</span>,
}

<span class='kw'>impl</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;</span> <span class='ident'>ODEiv2Driver</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;</span> {
    <span class='doccomment'>/// These functions return a pointer to a newly allocated instance of a driver object. The functions automatically allocate and initialise</span>
    <span class='doccomment'>/// the evolve, control and stepper objects for ODE system sys using stepper type T. The initial step size is given in hstart. The rest</span>
    <span class='doccomment'>/// of the arguments follow the syntax and semantics of the control functions with same name (gsl_odeiv2_control_*_new).</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>alloc_y_new</span>(<span class='ident'>sys</span>: <span class='kw-2'>&amp;</span><span class='lifetime'>&#39;a</span> <span class='kw-2'>mut</span> <span class='ident'>ODEiv2System</span>, <span class='ident'>t</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2StepType</span>, <span class='ident'>hstart</span>: <span class='ident'>f64</span>, <span class='ident'>epsabs</span>: <span class='ident'>f64</span>, <span class='ident'>epsrel</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>ODEiv2Driver</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>sys_raw</span> <span class='op'>=</span> <span class='ident'>Box</span>::<span class='ident'>new</span>(<span class='ident'>sys</span>.<span class='ident'>to_raw</span>());
        <span class='kw'>let</span> <span class='ident'>psys</span> <span class='op'>=</span> <span class='kw-2'>&amp;</span><span class='op'>*</span><span class='ident'>sys_raw</span> <span class='kw'>as</span> <span class='op'>*</span><span class='kw'>const</span> _;
        <span class='kw'>let</span> <span class='ident'>tmp</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_driver_alloc_y_new</span>(<span class='ident'>psys</span>, <span class='ident'>t</span>.<span class='ident'>t</span>, <span class='ident'>hstart</span>, <span class='ident'>epsabs</span>, <span class='ident'>epsrel</span>) };

        <span class='kw'>if</span> <span class='ident'>tmp</span>.<span class='ident'>is_null</span>() {
            <span class='prelude-val'>None</span>
        } <span class='kw'>else</span> {
            <span class='prelude-val'>Some</span>(<span class='ident'>ODEiv2Driver</span> {
                <span class='ident'>d</span>: <span class='ident'>tmp</span>,
                <span class='ident'>raw_system</span>: <span class='ident'>sys_raw</span>,
                <span class='ident'>phantom</span>: ::<span class='ident'>std</span>::<span class='ident'>marker</span>::<span class='ident'>PhantomData</span>,
            })
        }
    }

    <span class='doccomment'>/// These functions return a pointer to a newly allocated instance of a driver object. The functions automatically allocate and initialise</span>
    <span class='doccomment'>/// the evolve, control and stepper objects for ODE system sys using stepper type T. The initial step size is given in hstart. The rest</span>
    <span class='doccomment'>/// of the arguments follow the syntax and semantics of the control functions with same name (gsl_odeiv2_control_*_new).</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>alloc_yp_new</span>(<span class='ident'>sys</span>: <span class='kw-2'>&amp;</span><span class='lifetime'>&#39;a</span> <span class='kw-2'>mut</span> <span class='ident'>ODEiv2System</span>, <span class='ident'>t</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2StepType</span>, <span class='ident'>hstart</span>: <span class='ident'>f64</span>, <span class='ident'>epsabs</span>: <span class='ident'>f64</span>, <span class='ident'>epsrel</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>ODEiv2Driver</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>sys_raw</span> <span class='op'>=</span> <span class='ident'>Box</span>::<span class='ident'>new</span>(<span class='ident'>sys</span>.<span class='ident'>to_raw</span>());
        <span class='kw'>let</span> <span class='ident'>psys</span> <span class='op'>=</span> <span class='kw-2'>&amp;</span><span class='op'>*</span><span class='ident'>sys_raw</span> <span class='kw'>as</span> <span class='op'>*</span><span class='kw'>const</span> _;
        <span class='kw'>let</span> <span class='ident'>tmp</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_driver_alloc_yp_new</span>(<span class='ident'>psys</span>, <span class='ident'>t</span>.<span class='ident'>t</span>, <span class='ident'>hstart</span>, <span class='ident'>epsabs</span>, <span class='ident'>epsrel</span>) };

        <span class='kw'>if</span> <span class='ident'>tmp</span>.<span class='ident'>is_null</span>() {
            <span class='prelude-val'>None</span>
        } <span class='kw'>else</span> {
            <span class='prelude-val'>Some</span>(<span class='ident'>ODEiv2Driver</span> {
                <span class='ident'>d</span>: <span class='ident'>tmp</span>,
                <span class='ident'>raw_system</span>: <span class='ident'>sys_raw</span>,
                <span class='ident'>phantom</span>: ::<span class='ident'>std</span>::<span class='ident'>marker</span>::<span class='ident'>PhantomData</span>,
            })
        }
    }

    <span class='doccomment'>/// These functions return a pointer to a newly allocated instance of a driver object. The functions automatically allocate and initialise</span>
    <span class='doccomment'>/// the evolve, control and stepper objects for ODE system sys using stepper type T. The initial step size is given in hstart. The rest</span>
    <span class='doccomment'>/// of the arguments follow the syntax and semantics of the control functions with same name (gsl_odeiv2_control_*_new).</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>alloc_standard_new</span>(<span class='ident'>sys</span>: <span class='kw-2'>&amp;</span><span class='lifetime'>&#39;a</span> <span class='kw-2'>mut</span> <span class='ident'>ODEiv2System</span>, <span class='ident'>t</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2StepType</span>, <span class='ident'>hstart</span>: <span class='ident'>f64</span>, <span class='ident'>epsabs</span>: <span class='ident'>f64</span>, <span class='ident'>epsrel</span>: <span class='ident'>f64</span>, <span class='ident'>a_y</span>: <span class='ident'>f64</span>,
        <span class='ident'>a_dydt</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>ODEiv2Driver</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>sys_raw</span> <span class='op'>=</span> <span class='ident'>Box</span>::<span class='ident'>new</span>(<span class='ident'>sys</span>.<span class='ident'>to_raw</span>());
        <span class='kw'>let</span> <span class='ident'>psys</span> <span class='op'>=</span> <span class='kw-2'>&amp;</span><span class='op'>*</span><span class='ident'>sys_raw</span> <span class='kw'>as</span> <span class='op'>*</span><span class='kw'>const</span> _;
        <span class='kw'>let</span> <span class='ident'>tmp</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_driver_alloc_standard_new</span>(<span class='ident'>psys</span>, <span class='ident'>t</span>.<span class='ident'>t</span>, <span class='ident'>hstart</span>, <span class='ident'>epsabs</span>, <span class='ident'>epsrel</span>, <span class='ident'>a_y</span>, <span class='ident'>a_dydt</span>) };

        <span class='kw'>if</span> <span class='ident'>tmp</span>.<span class='ident'>is_null</span>() {
            <span class='prelude-val'>None</span>
        } <span class='kw'>else</span> {
            <span class='prelude-val'>Some</span>(<span class='ident'>ODEiv2Driver</span> {
                <span class='ident'>d</span>: <span class='ident'>tmp</span>,
                <span class='ident'>raw_system</span>: <span class='ident'>sys_raw</span>,
                <span class='ident'>phantom</span>: ::<span class='ident'>std</span>::<span class='ident'>marker</span>::<span class='ident'>PhantomData</span>,
            })
        }
    }

    <span class='doccomment'>/// These functions return a pointer to a newly allocated instance of a driver object. The functions automatically allocate and initialise</span>
    <span class='doccomment'>/// the evolve, control and stepper objects for ODE system sys using stepper type T. The initial step size is given in hstart. The rest</span>
    <span class='doccomment'>/// of the arguments follow the syntax and semantics of the control functions with same name (gsl_odeiv2_control_*_new).</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>alloc_scaled_new</span>(<span class='ident'>sys</span>: <span class='kw-2'>&amp;</span><span class='lifetime'>&#39;a</span> <span class='kw-2'>mut</span> <span class='ident'>ODEiv2System</span>, <span class='ident'>t</span>: <span class='kw-2'>&amp;</span><span class='ident'>ODEiv2StepType</span>, <span class='ident'>hstart</span>: <span class='ident'>f64</span>, <span class='ident'>epsabs</span>: <span class='ident'>f64</span>, <span class='ident'>epsrel</span>: <span class='ident'>f64</span>, <span class='ident'>a_y</span>: <span class='ident'>f64</span>, <span class='ident'>a_dydt</span>: <span class='ident'>f64</span>,
        <span class='ident'>scale_abs</span>: <span class='kw-2'>&amp;</span>[<span class='ident'>f64</span>]) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>ODEiv2Driver</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;&gt;</span> {
        <span class='kw'>let</span> <span class='ident'>sys_raw</span> <span class='op'>=</span> <span class='ident'>Box</span>::<span class='ident'>new</span>(<span class='ident'>sys</span>.<span class='ident'>to_raw</span>());
        <span class='kw'>let</span> <span class='ident'>psys</span> <span class='op'>=</span> <span class='kw-2'>&amp;</span><span class='op'>*</span><span class='ident'>sys_raw</span> <span class='kw'>as</span> <span class='op'>*</span><span class='kw'>const</span> _;
        <span class='kw'>let</span> <span class='ident'>tmp</span> <span class='op'>=</span> <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_driver_alloc_scaled_new</span>(<span class='ident'>psys</span>, <span class='ident'>t</span>.<span class='ident'>t</span>, <span class='ident'>hstart</span>, <span class='ident'>epsabs</span>, <span class='ident'>epsrel</span>, <span class='ident'>a_y</span>, <span class='ident'>a_dydt</span>,
            <span class='ident'>scale_abs</span>.<span class='ident'>as_ptr</span>()) };

        <span class='kw'>if</span> <span class='ident'>tmp</span>.<span class='ident'>is_null</span>() {
            <span class='prelude-val'>None</span>
        } <span class='kw'>else</span> {
            <span class='prelude-val'>Some</span>(<span class='ident'>ODEiv2Driver</span> {
                <span class='ident'>d</span>: <span class='ident'>tmp</span>,
                <span class='ident'>raw_system</span>: <span class='ident'>sys_raw</span>,
                <span class='ident'>phantom</span>: ::<span class='ident'>std</span>::<span class='ident'>marker</span>::<span class='ident'>PhantomData</span>,
            })
        }
    }

    <span class='doccomment'>/// The function sets a minimum for allowed step size hmin for driver self. Default value is 0.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>set_hmin</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>hmin</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span> {
        <span class='ident'>GSLResult</span>::<span class='ident'>from</span>(<span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_driver_set_hmin</span>(<span class='self'>self</span>.<span class='ident'>d</span>, <span class='ident'>hmin</span>) })
    }

    <span class='doccomment'>/// The function sets a maximum for allowed step size hmax for driver self. Default value is ::DBL_MAX.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>set_hmax</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>hmax</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span> {
        <span class='ident'>GSLResult</span>::<span class='ident'>from</span>(<span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_driver_set_hmax</span>(<span class='self'>self</span>.<span class='ident'>d</span>, <span class='ident'>hmax</span>) })
    }

    <span class='doccomment'>/// The function sets a maximum for allowed number of steps nmax for driver self. Default value of 0 sets no limit for steps.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>set_nmax</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>nmax</span>: <span class='ident'>usize</span>) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span> {
        <span class='ident'>GSLResult</span>::<span class='ident'>from</span>(<span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_driver_set_nmax</span>(<span class='self'>self</span>.<span class='ident'>d</span>, <span class='ident'>nmax</span>) })
    }

    <span class='doccomment'>/// This function evolves the driver system d from t to t1. Initially vector y should contain the values of dependent variables at</span>
    <span class='doccomment'>/// point t. If the function is unable to complete the calculation, an error code from gsl_odeiv2_evolve_apply is returned, and t and</span>
    <span class='doccomment'>/// y contain the values from last successful step.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// If maximum number of steps is reached, a value of enums::Value::MaxIteration is returned. If the step size drops below minimum value, the</span>
    <span class='doccomment'>/// function returns with ::NoProg. If the user-supplied functions defined in the system sys returns enums::value::BadFunc, the function</span>
    <span class='doccomment'>/// returns immediately with the same return code. In this case the user must call gsl_odeiv2_driver_reset before calling this</span>
    <span class='doccomment'>/// function again.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>apply</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>t</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>f64</span>, <span class='ident'>t1</span>: <span class='ident'>f64</span>, <span class='ident'>y</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> [<span class='ident'>f64</span>]) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span> {
        <span class='ident'>GSLResult</span>::<span class='ident'>from</span>(<span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_driver_apply</span>(<span class='self'>self</span>.<span class='ident'>d</span>, <span class='ident'>t</span>, <span class='ident'>t1</span>, <span class='ident'>y</span>.<span class='ident'>as_mut_ptr</span>()) })
    }

    <span class='doccomment'>/// This function evolves the driver system d from t with n steps of size h. If the function is unable to complete the calculation, an</span>
    <span class='doccomment'>/// error code from gsl_odeiv2_evolve_apply_fixed_step is returned, and t and y contain the values from last successful step.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>apply_fixed_step</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>t</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>f64</span>, <span class='ident'>h</span>: <span class='ident'>f64</span>, <span class='ident'>n</span>: <span class='ident'>usize</span>, <span class='ident'>y</span>: <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> [<span class='ident'>f64</span>]) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span> {
        <span class='ident'>GSLResult</span>::<span class='ident'>from</span>(<span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_driver_apply_fixed_step</span>(<span class='self'>self</span>.<span class='ident'>d</span>, <span class='ident'>t</span>, <span class='ident'>h</span>, <span class='ident'>n</span>, <span class='ident'>y</span>.<span class='ident'>as_mut_ptr</span>()) })
    }

    <span class='doccomment'>/// This function resets the evolution and stepper objects.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>reset</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span> {
        <span class='ident'>GSLResult</span>::<span class='ident'>from</span>(<span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_driver_reset</span>(<span class='self'>self</span>.<span class='ident'>d</span>) })
    }

    <span class='doccomment'>/// The routine resets the evolution and stepper objects and sets new initial step size to hstart. This function can be used e.g. to</span>
    <span class='doccomment'>/// change the direction of integration.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>reset_hstart</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>hstart</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='ident'>GSLResult</span><span class='op'>&lt;</span>()<span class='op'>&gt;</span> {
        <span class='ident'>GSLResult</span>::<span class='ident'>from</span>(<span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_driver_reset_hstart</span>(<span class='self'>self</span>.<span class='ident'>d</span>, <span class='ident'>hstart</span>) })
    }
}

<span class='kw'>impl</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;</span> <span class='ident'>Drop</span> <span class='kw'>for</span> <span class='ident'>ODEiv2Driver</span><span class='op'>&lt;</span><span class='lifetime'>&#39;a</span><span class='op'>&gt;</span> {
    <span class='kw'>fn</span> <span class='ident'>drop</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) {
        <span class='kw'>unsafe</span> { <span class='ident'>ffi</span>::<span class='ident'>gsl_odeiv2_driver_free</span>(<span class='self'>self</span>.<span class='ident'>d</span>) };
        <span class='self'>self</span>.<span class='ident'>d</span> <span class='op'>=</span> ::<span class='ident'>std</span>::<span class='ident'>ptr</span>::<span class='ident'>null_mut</span>();
    }
}

<span class='comment'>// We cannot wrap a driver object since we need a boxed gsl_odeiv2_system.</span>
<span class='comment'>// impl&lt;&#39;a&gt; ffi::FFI&lt;ffi::gsl_odeiv2_driver&gt; for ODEiv2Driver&lt;&#39;a&gt; {</span>
<span class='comment'>//     fn wrap(d: *mut ffi::gsl_odeiv2_driver) -&gt; ODEiv2Driver&lt;&#39;a&gt; {</span>
<span class='comment'>//         ODEiv2Driver {</span>
<span class='comment'>//             d: d,</span>
<span class='comment'>//             phantom: ::std::marker::PhantomData,</span>
<span class='comment'>//         }</span>
<span class='comment'>//     }</span>
<span class='comment'>//</span>
<span class='comment'>//     fn unwrap(d: &amp;ODEiv2Driver) -&gt; *mut ffi::gsl_odeiv2_driver {</span>
<span class='comment'>//         d.d</span>
<span class='comment'>//     }</span>
<span class='comment'>// }</span>
</pre>
</section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                    <dt>+</dt>
                    <dd>Collapse/expand all sections</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../../../";
        window.currentCrate = "rgsl";
        window.playgroundUrl = "";
    </script>
    <script src="../../../jquery.js"></script>
    <script src="../../../main.js"></script>
    
    <script defer src="../../../search-index.js"></script>
</body>
</html>